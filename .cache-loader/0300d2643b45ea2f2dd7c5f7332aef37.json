{"remainingRequest":"/Users/w/var/www/centerofthegoldenone.com/www/wp-content/themes/CGO/node_modules/babel-loader/lib/index.js??ref--0-1!/Users/w/var/www/centerofthegoldenone.com/www/wp-content/themes/CGO/js/components/pages/offerings/index.js","dependencies":[{"path":"/Users/w/var/www/centerofthegoldenone.com/www/wp-content/themes/CGO/js/components/pages/offerings/index.js","mtime":1517861130859},{"path":"/Users/w/var/www/centerofthegoldenone.com/www/wp-content/themes/CGO/.babelrc","mtime":1517509482985},{"path":"/Users/w/var/www/centerofthegoldenone.com/www/wp-content/themes/CGO/node_modules/cache-loader/dist/cjs.js","mtime":1510929699000},{"path":"/Users/w/var/www/centerofthegoldenone.com/www/wp-content/themes/CGO/node_modules/babel-loader/lib/index.js","mtime":1503096278000}],"contextDependencies":[],"result":["'use strict';\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _moment = require('moment');\n\nvar _moment2 = _interopRequireDefault(_moment);\n\nrequire('../../../../scss/pages/offerings.scss');\n\nvar _templateElements = require('./templateElements');\n\nvar _SAMPLE_DATA = require('./SAMPLE_DATA');\n\nvar _faker = require('faker');\n\nvar _faker2 = _interopRequireDefault(_faker);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\njQuery(document).ready(function ($) {\n  var splitPath = window.location.pathname.split('/');\n  var path = splitPath[splitPath.length - 2];\n  if (path === 'offerings') {\n    path = 'meditation';\n  }\n\n  var activeLocationSlug = 'denver';\n  var activeTypeFilter = 'all';\n  var shouldUpdateEvents = false;\n  var monthsExpanded = {};\n  // let fullyTransformedEventSet = SAMPLE_DATA.events.meditation\n\n  var currentList = _SAMPLE_DATA.meditationTypes;\n  if (path === 'introductory') {\n    currentList = _SAMPLE_DATA.introductoryTypes;\n  } else if (path === 'seminars') {\n    currentList = _SAMPLE_DATA.seminarTypes;\n  }\n\n  var getCorrectEventSet = function getCorrectEventSet(eventObj) {\n    var formatPath = path;\n    var upcomingName = formatPath;\n    // if (path === 'offerings') { formatPath = 'meditation' }\n    if (formatPath === 'meditation') {\n      upcomingName = 'Meditations';\n    } else if (formatPath === 'introductory') {\n      upcomingName = 'Introductory Events';\n    }\n\n    $('.az-upcoming-category').text('Upcoming ' + upcomingName);\n    var _iteratorNormalCompletion = true;\n    var _didIteratorError = false;\n    var _iteratorError = undefined;\n\n    try {\n      for (var _iterator = Object.keys(eventObj)[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n        var eventType = _step.value;\n\n        if (eventType === formatPath) {\n          return eventObj[eventType];\n        }\n      }\n    } catch (err) {\n      _didIteratorError = true;\n      _iteratorError = err;\n    } finally {\n      try {\n        if (!_iteratorNormalCompletion && _iterator.return) {\n          _iterator.return();\n        }\n      } finally {\n        if (_didIteratorError) {\n          throw _iteratorError;\n        }\n      }\n    }\n  };\n\n  var bindEventsToLocations = function bindEventsToLocations(eventList) {\n    return eventList.sort(function (a, b) {\n      return (0, _moment2.default)(a.date, 'X') - (0, _moment2.default)(b.date, 'X');\n    }).map(function (event) {\n      var eventLocation = function eventLocation() {\n        var _iteratorNormalCompletion2 = true;\n        var _didIteratorError2 = false;\n        var _iteratorError2 = undefined;\n\n        try {\n          for (var _iterator2 = _SAMPLE_DATA.SAMPLE_DATA.locations[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n            var location = _step2.value;\n\n            if (location.place_id === event.location_id) {\n              return location;\n            }\n          }\n        } catch (err) {\n          _didIteratorError2 = true;\n          _iteratorError2 = err;\n        } finally {\n          try {\n            if (!_iteratorNormalCompletion2 && _iterator2.return) {\n              _iterator2.return();\n            }\n          } finally {\n            if (_didIteratorError2) {\n              throw _iteratorError2;\n            }\n          }\n        }\n      };\n      var eLoc = eventLocation();\n      var phone = eLoc.phone,\n          address = eLoc.address;\n\n      return _extends({\n        location_title: eLoc.title,\n        slug: eLoc.menu_slug,\n        address: address,\n        phone: phone\n      }, event);\n    });\n  };\n\n  var filterByLocation = function filterByLocation(eventList) {\n    return eventList.filter(function (event) {\n      return event.slug === activeLocationSlug;\n    });\n  };\n\n  var filterByType = function filterByType(eventList) {\n    var filteredList = activeTypeFilter === 'all' ? eventList : eventList.filter(function (event) {\n      return event.type === activeTypeFilter.replace(' ', '_').toLowerCase();\n    });\n    return filteredList;\n  };\n\n  var fullyTransformTheseEvents = function fullyTransformTheseEvents(allEvents) {\n    var correctFlatEventSet = getCorrectEventSet(allEvents);\n    // console.log(correctFlatEventSet);\n    var eventsWithLocations = bindEventsToLocations(correctFlatEventSet);\n    console.log(eventsWithLocations);\n    var thisLocationEvents = filterByLocation(eventsWithLocations);\n    console.log(thisLocationEvents);\n    var thisTypeEvents = filterByType(thisLocationEvents);\n    console.log(thisTypeEvents);\n    var splitEventObj = { Recurring: [] };\n\n    thisTypeEvents.forEach(function (event) {\n      if (event.recurring) {\n        splitEventObj.Recurring.push(event);\n      } else {\n        console.log(event.date);\n        var month = event.date.split(' ')[0];\n        if (!splitEventObj[month]) {\n          splitEventObj[month] = [];\n        }\n        splitEventObj[month].push(event);\n        monthsExpanded[month] = false;\n      }\n    });\n\n    console.log(splitEventObj);\n\n    // fullyTransformedEventSet = thisTypeEvents\n    return splitEventObj;\n    // return thisTypeEvents\n  };\n\n  var fullyTransformedEventSet = fullyTransformTheseEvents(_SAMPLE_DATA.SAMPLE_DATA.events);\n\n  var setActiveItemFilter = function setActiveItemFilter(element, matchedString) {\n    shouldUpdateEvents = false;\n\n    element.each(function (i, item) {\n      // console.log(item, matchedString);\n      // console.log($(item).text() === matchedString);\n      $(item).text() === matchedString || $(item).text() === matchedString.toUpperCase() ? $(item).addClass('active') : $(item).removeClass('active');\n      $(item).click(function (e) {\n        e.preventDefault();\n        var thisMatchedString = $(e.target).text();\n\n        shouldUpdateEvents = true;\n\n        if (shouldUpdateEvents) {\n          setActiveItemFilter(element, thisMatchedString);\n          $('.az-offerings-location-detail-wrapper').empty();\n          fullyTransformedEventSet = fullyTransformTheseEvents(_SAMPLE_DATA.SAMPLE_DATA.events);\n          renderEventData();\n        }\n      });\n    });\n    // element.click((e) => {\n    //   e.preventDefault()\n    //   const thisMatchedString = $(e.target).text()\n    //   setActiveItemFilter(element, thisMatchedString)\n\n    //   // initDoc() << infinite loop\n    //   $('.az-offerings-location-detail-wrapper').empty()\n    //   fullyTransformedEventSet = fullyTransformTheseEvents(SAMPLE_DATA.events)\n    //   renderEventData()\n    // })\n\n    // if (opFunc) {\n    //   opFunc()\n    // }\n  };\n\n  var setActiveMenuItem = function setActiveMenuItem() {\n    var subheadLinks = $('.az-offerings-submenu-wrapper a');\n    var formatPath = path;\n    if (path === 'introductory') {\n      formatPath = path + ' events';\n    }\n    // console.log(subheadLinks, formatPath);\n    setActiveItemFilter(subheadLinks, formatPath);\n  };\n\n  var renderTypesFilter = function renderTypesFilter() {\n    currentList.forEach(function (item) {\n      var formatItem = item.replace(/[^a-zA-z]/g, '_');\n      if ($('#az-offerings-filter-focus').children('#' + formatItem).length < 1) {\n        $('#az-offerings-filter-focus').append($('\\n          <li id=\\'' + formatItem + '\\' class=\\'az-offerings-filter-item\\'>\\n            <a>' + item + '</a>\\n          </li>\\n        '));\n      }\n    });\n    setActiveItemFilter($('.az-offerings-filter-item').children('a'), activeTypeFilter);\n  };\n\n  var renderTypesDescriptionBlocks = function renderTypesDescriptionBlocks() {\n    var txtContainer = $('.az-offerings-types-description-container');\n    currentList.forEach(function (title) {\n      var flatTitle = title.replace(/[^a-zA-z]/g, '_');\n      if (txtContainer.children('#' + flatTitle).length < 1) {\n        txtContainer.append((0, _templateElements.descriptionTxtBlock)(title, flatTitle));\n      }\n    });\n    var blockEl = $('.az-offerings-types-description-container .txt-block');\n    blockEl.css('width', 100 / currentList.length + '%');\n    var newWidth = blockEl.css('width');\n    blockEl.css('height', newWidth);\n  };\n\n  var renderEventData = function renderEventData() {\n    var formatPath = path;\n    if (path === 'offerings') {\n      formatPath = 'meditation';\n    }\n    var detailsWrapper = $('.az-offerings-location-detail-wrapper');\n\n    if (detailsWrapper.children('#' + event.id).length < 1) {\n      Object.keys(fullyTransformedEventSet).forEach(function (type) {\n        detailsWrapper.append($('<div class=\\'' + type + '\\'>' + type + '</div>'));\n        fullyTransformedEventSet[type].forEach(function (event) {\n          if ($('.' + type).children('#' + event.id).length < 1) {\n            $('.' + type).append((0, _templateElements.detailInner)(event));\n          }\n        });\n        if (type !== 'Recurring') {\n          $('.' + type).children().hide();\n        }\n      });\n    }\n\n    // fullyTransformedEventSet.forEach(event => {\n    //   // console.log(event);\n    //   if (detailsWrapper.children(`#${event.id}`).length < 1) {\n    //     detailsWrapper.append(detailInner(event))\n    //   }\n    // })\n  };\n\n  var handleExpandingMonths = function handleExpandingMonths() {\n    var monthKeys = Object.keys(monthsExpanded);\n    monthKeys.forEach(function (month) {\n      $('.' + month).click(function () {\n        $('.' + month).children().toggle(300);\n      });\n    });\n  };\n\n  var renderLocationsMenu = function renderLocationsMenu() {\n    var menuWrapper = $('.az-offerings-locations-menu-wrapper ul');\n    var locations = _SAMPLE_DATA.SAMPLE_DATA.locations;\n\n\n    locations.forEach(function (location) {\n      if (menuWrapper.children('#' + location.menu_slug).length < 1) {\n        menuWrapper.append('\\n          <li id=\\'' + location.menu_slug + '\\' class=\\'az-offerings-locations-menu-item\\'>\\n            <a>' + location.menu_slug.replace('_', ' ') + '</a>\\n          </li>\\n        ');\n      }\n    });\n    setActiveItemFilter($('.az-offerings-locations-menu-item').children('a'), activeLocationSlug);\n  };\n\n  function initDoc() {\n    setActiveMenuItem();\n    renderTypesFilter();\n    renderTypesDescriptionBlocks();\n    renderEventData();\n    renderLocationsMenu();\n  }\n\n  initDoc();\n});",null]}